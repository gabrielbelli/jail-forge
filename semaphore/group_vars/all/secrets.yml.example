---
# Centralized Secrets and Configuration
# IMPORTANT: Copy this file to secrets.yml and update with your values
# Then encrypt with: ansible-vault encrypt group_vars/all/secrets.yml

# =============================================================================
# DATABASE SECRETS
# =============================================================================
postgres_admin_password: "changeme_generate_with_openssl_rand_base64_32"
semaphore_db_name: "semaphore"
semaphore_db_user: "semaphore"
semaphore_db_password: "changeme_generate_with_openssl_rand_base64_32"

# =============================================================================
# SEMAPHORE APPLICATION SECRETS
# =============================================================================
semaphore_admin_user: "admin"
semaphore_admin_email: "admin@example.com"
semaphore_admin_password: "changeme_generate_with_openssl_rand_base64_32"
semaphore_admin_name: "Administrator"

# Semaphore encryption keys (generate with: openssl rand -base64 32)
semaphore_cookie_hash: "changeme_generate_with_openssl_rand_base64_32"
semaphore_cookie_encryption: "changeme_generate_with_openssl_rand_base64_32"
semaphore_access_key_encryption: "changeme_generate_with_openssl_rand_base64_32"

# =============================================================================
# TLS/SSL CERTIFICATE CONFIGURATION
# =============================================================================

# Certificate management strategy
# Options: "generate" | "existing"
tls_cert_strategy: "generate"

# Generate self-signed certificates (when tls_cert_strategy: "generate")
tls_generate_selfsigned: true
tls_cert_lifetime_days: 3650  # 10 years for self-signed
tls_cert_key_size: 4096       # RSA key size

# Certificate details
tls_cert_country: "US"
tls_cert_state: "State"
tls_cert_locality: "City"
tls_cert_organization: "Your Organization"
tls_cert_organizational_unit: "IT"
tls_cert_common_name: "semaphore.example.com"
tls_cert_email: "admin@example.com"

# Enable/disable TLS (recommended: true)
tls_enabled: true

# Subject Alternative Names (SANs) for certificate
tls_cert_san:
  - "DNS:semaphore.example.com"
  - "DNS:*.example.com"
  - "IP:192.168.1.51"  # Update with your jail IP

# Existing certificate paths (when tls_cert_strategy: "existing")
# These files will be copied from your control machine to the Semaphore jail
tls_existing_cert_path: "/path/to/your/certificate.crt"
tls_existing_key_path: "/path/to/your/private.key"
tls_existing_ca_path: "/path/to/your/ca-bundle.crt"  # Optional

# Certificate file paths on the Semaphore jail
tls_cert_dir: "/usr/local/etc/ssl"
tls_cert_file: "{{ tls_cert_dir }}/semaphore.crt"
tls_key_file: "{{ tls_cert_dir }}/semaphore.key"
tls_ca_file: "{{ tls_cert_dir }}/ca-bundle.crt"

# =============================================================================
# CUSTOM CA CERTIFICATES (for LDAPS, etc.)
# =============================================================================

# Import custom CA certificates into the jail's trust store
# This is required for LDAPS with self-signed CAs, or any service using custom CAs
custom_ca_enabled: false

# List of CA certificate files to import
# These files should exist on your control machine and will be copied to the jail
custom_ca_certificates: []
  # - path: "/path/to/ldap-ca.crt"
  #   name: "ldap-ca"
  # - path: "/path/to/another-ca.crt"
  #   name: "another-ca"

# CA certificates directory in jail
custom_ca_dir: "/usr/local/share/certs"

# =============================================================================
# NETWORK CONFIGURATION
# =============================================================================
jail_network_cidr: "192.168.1.0/24"  # Update with your network
jail_gateway: "192.168.1.1"          # Update with your gateway
jail_interface: "em0"                 # Update with your interface (em0, igb0, etc.)

# Jail IP addresses (must be available in your network)
jail_ip_database: "192.168.1.50"
jail_ip_semaphore: "192.168.1.51"

# Semaphore port (default: 3000)
semaphore_port: 3000

# =============================================================================
# SYSTEM CONFIGURATION
# =============================================================================
freebsd_version: "13.5-RELEASE"  # Or your FreeBSD version
freebsd_arch: "amd64"
zfs_pool: "zroot"                # Or your ZFS pool name
jail_dataset: "jails"

# =============================================================================
# BACKUP CONFIGURATION (Data-only IaC approach)
# =============================================================================

# Backup location on BSD host (BSD standard: /var/backups)
backup_location: "/var/backups/semaphore"

# How long to keep old backups (days)
backup_retention_days: 30

# Maximum number of backups to keep (set to 0 to disable count-based retention)
backup_retention_count: 10

# Compress entire backup into single tar.gz (optional)
backup_compress: false

# Create ZFS snapshots for quick rollback (optional)
# Note: Not needed with IaC approach, but useful for instant rollback
backup_zfs_snapshots: false

# Backup encryption (optional)
backup_encryption_enabled: false
backup_encryption_password: "changeme_backup_encryption_password"

# =============================================================================
# NOTES
# =============================================================================
# 1. Copy this file to secrets.yml:
#    cp group_vars/all/secrets.yml.example group_vars/all/secrets.yml
#
# 2. Generate strong random passwords:
#    openssl rand -base64 32
#
# 3. Generate Semaphore encryption keys:
#    openssl rand -hex 32
#
# 4. Encrypt this file after editing:
#    ansible-vault encrypt group_vars/all/secrets.yml
#
# 5. Edit encrypted file:
#    ansible-vault edit group_vars/all/secrets.yml
#
# 6. Run playbooks with vault:
#    ansible-playbook site.yml --ask-vault-pass
#    # or
#    ansible-playbook site.yml --vault-password-file .vault_pass
#
# 7. To use existing certificates:
#    - Set tls_cert_strategy: "existing"
#    - Update tls_existing_cert_path and tls_existing_key_path
#    - Ensure files exist on your control machine
#
# 8. Certificate management:
#    - Certificates are only generated if they don't exist
#    - To regenerate: delete cert files in jail and redeploy
#    - Certificate lifetime is configurable via tls_cert_lifetime_days
#    - Both self-signed and existing certificates are supported
#
# 9. Custom CA certificates (for LDAPS with self-signed CAs):
#    - Set custom_ca_enabled: true
#    - Add CA certificate paths to custom_ca_certificates list
#    - Certificates will be imported into the jail's system trust store
#    - Required for LDAPS, custom Git servers, or any service with self-signed certs
